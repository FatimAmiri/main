
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>XFunc &#8212; COMPAS 0.7.1 documentation</title>
    <link rel="stylesheet" href="../../_static/css/compas.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="XFunc.__init__" href="compas.utilities.XFunc.__init__.html" />
    <link rel="prev" title="standard_deviation" href="compas.utilities.standard_deviation.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="compas.utilities.XFunc.__init__.html" title="XFunc.__init__"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="compas.utilities.standard_deviation.html" title="standard_deviation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">COMPAS 0.7.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../api.html" >API Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../compas.html" >compas</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../compas.utilities.html" accesskey="U">utilities</a> &#187;</li> 
      </ul>
    </div>

                    

                    <div class="detail section" id="xfunc">
<h1>XFunc</h1>
<dl class="class">
<dt id="compas.utilities.XFunc">
<em class="property">class </em><code class="sig-prename descclassname">compas.utilities.</code><code class="sig-name descname">XFunc</code><span class="sig-paren">(</span><em class="sig-param">funcname</em>, <em class="sig-param">basedir='.'</em>, <em class="sig-param">tmpdir=None</em>, <em class="sig-param">delete_files=True</em>, <em class="sig-param">verbose=True</em>, <em class="sig-param">callback=None</em>, <em class="sig-param">callback_args=None</em>, <em class="sig-param">python=None</em>, <em class="sig-param">paths=None</em>, <em class="sig-param">serializer='json'</em>, <em class="sig-param">argtypes=None</em>, <em class="sig-param">kwargtypes=None</em>, <em class="sig-param">restypes=None</em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Wrapper for functions that turns them into externally run processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>funcname</strong> (<em>str</em>) – The full name of the function.</p></li>
<li><p><strong>basedir</strong> (<em>str, optional</em>) – A directory that should be added to the PYTHONPATH such that the function can be found.
Default is the curent directory.</p></li>
<li><p><strong>tmpdir</strong> (<em>str, optional</em>) – A directory that should be used for storing the IO files.
Default is the current directory.</p></li>
<li><p><strong>delete_files</strong> (<em>bool, optional</em>) – Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> if the IO files should not be deleted afterwards.
Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>verbose</strong> (<em>bool, optional</em>) – Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> if no information about the process should be displayed
to the user. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>callback</strong> (<em>callable, optional</em>) – A function to be called eveytime the wrapped function prints output.
The first parameter passed to this function is the line printed by the
wrapped function. Additional parameters can be defined using <cite>callback_args</cite>.
Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>callback_args</strong> (<em>tuple, optional</em>) – Additional parameter for the callback function.
Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>python</strong> (<em>str, optional</em>) – The Python executable.
This can be a path to a specific executable (e.g. <code class="docutils literal notranslate"><span class="pre">'/opt/local/bin/python'</span></code>)
or the name of an executable registered on the system <code class="docutils literal notranslate"><span class="pre">PATH</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">'pythonw'</span></code>).
Default is <code class="docutils literal notranslate"><span class="pre">'pythonw'</span></code>.</p></li>
<li><p><strong>paths</strong> (<em>list, optional</em>) – A list of paths to be added to the <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> by the subprocess.
Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>serializer</strong> (<em>{‘json’, ‘pickle’}, optional</em>) – The serialisation mechnanism to be used to pass data between the caller and the subprocess.
Default is <code class="docutils literal notranslate"><span class="pre">'json'</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>data</strong> (<em>object</em>) – The object returned by the wrapped function.
This is <code class="docutils literal notranslate"><span class="pre">None</span></code> if something went wrong.</p></li>
<li><p><strong>profile</strong> (<em>str</em>) – A profile of the call to the wrapped function.
This is <code class="docutils literal notranslate"><span class="pre">None</span></code> if something went wrong.</p></li>
<li><p><strong>error</strong> (<em>str</em>) – A traceback of the exception raised during the wrapped function call.
This is <code class="docutils literal notranslate"><span class="pre">None</span></code> if nothing went wrong.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="compas.utilities.XFunc.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Call the wrapped function with the apropriate/related arguments and keyword
arguments.</p>
</dd></dl>

<p class="rubric">Notes</p>
<p>To use the Python executable of a virtual environment, simply assign the path
to that executable to the <code class="docutils literal notranslate"><span class="pre">python</span></code> parameter. For example</p>
<div class="language-python notranslate"><div class="highlight"><pre><code><span></span><span class="n">fd_numpy</span> <span class="o">=</span> <span class="n">XFunc</span><span class="p">(</span><span class="s1">&#39;compas.numerical.fd_numpy&#39;</span><span class="p">,</span> <span class="n">python</span><span class="o">=</span><span class="s1">&#39;/Users/brg/environments/py2/python&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
<p class="rubric">Examples</p>
<p><cite>compas.numerical</cite> provides an implementation of the Force Density Method that
is based on Numpy and Scipy. This implementation is not directly available in
Rhino because Numpy and Scipy are not available for IronPython.</p>
<p>With <cite>compas.utilities.XFunc</cite>, <cite>compas.numerical.fd_numpy</cite> can be easily
wrapped in an external process and called as if it would be directly available.</p>
<div class="language-python notranslate"><div class="highlight"><pre><code><span></span><span class="kn">import</span> <span class="nn">compas</span>
<span class="kn">import</span> <span class="nn">compas_rhino</span>

<span class="kn">from</span> <span class="nn">compas_rhino.artists</span> <span class="kn">import</span> <span class="n">MeshArtist</span>
<span class="kn">from</span> <span class="nn">compas.datastructures</span> <span class="kn">import</span> <span class="n">Mesh</span>
<span class="kn">from</span> <span class="nn">compas.utilities</span> <span class="kn">import</span> <span class="n">XFunc</span>

<span class="c1"># make the function available as a wrapped function with the same call signature and return value as the original.</span>
<span class="n">fd_numpy</span> <span class="o">=</span> <span class="n">XFunc</span><span class="p">(</span><span class="s1">&#39;compas.numerical.fd_numpy&#39;</span><span class="p">)</span>

<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_obj</span><span class="p">(</span><span class="n">compas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;faces.obj&#39;</span><span class="p">))</span>

<span class="n">mesh</span><span class="o">.</span><span class="n">update_default_vertex_attributes</span><span class="p">({</span><span class="s1">&#39;is_fixed&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s1">&#39;px&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;py&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;pz&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">update_default_edge_attributes</span><span class="p">({</span><span class="s1">&#39;q&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>

<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">(</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">attr</span><span class="p">[</span><span class="s1">&#39;is_fixed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vertex_degree</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>

<span class="n">key_index</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">key_index</span><span class="p">()</span>
<span class="n">vertices</span>  <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">get_vertices_attributes</span><span class="p">(</span><span class="s1">&#39;xyz&#39;</span><span class="p">)</span>
<span class="n">edges</span>     <span class="o">=</span> <span class="p">[(</span><span class="n">key_index</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">key_index</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">edges</span><span class="p">()]</span>
<span class="n">fixed</span>     <span class="o">=</span> <span class="p">[</span><span class="n">key_index</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vertices_where</span><span class="p">({</span><span class="s1">&#39;is_fixed&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">})]</span>
<span class="n">q</span>         <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">get_edges_attribute</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">loads</span>     <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">get_vertices_attributes</span><span class="p">((</span><span class="s1">&#39;px&#39;</span><span class="p">,</span> <span class="s1">&#39;py&#39;</span><span class="p">,</span> <span class="s1">&#39;pz&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>

<span class="n">xyz</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">fd_numpy</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">loads</span><span class="p">)</span>

<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">(</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">attr</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">attr</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">attr</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>

<span class="n">artist</span> <span class="o">=</span> <span class="n">MeshArtist</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="n">artist</span><span class="o">.</span><span class="n">draw_vertices</span><span class="p">()</span>
<span class="n">artist</span><span class="o">.</span><span class="n">draw_edges</span><span class="p">()</span>
</code></pre></div>
</div>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="compas.utilities.XFunc.__init__.html#compas.utilities.XFunc.__init__" title="compas.utilities.XFunc.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(funcname[, basedir, tmpdir, …])</p></td>
<td><p>Initialize self.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Inherited Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
</dd></dl>

</div>

                    
                
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="compas.utilities.XFunc.__init__.html" title="XFunc.__init__"
             >next</a> |</li>
        <li class="right" >
          <a href="compas.utilities.standard_deviation.html" title="standard_deviation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">COMPAS 0.7.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../api.html" >API Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../compas.html" >compas</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../compas.utilities.html" >utilities</a> &#187;</li> 
      </ul>
    </div> <footer class="compas-footer">
    
        
            &#169; Copyright Block Research Group - ETH Zurich.
        
    

    
        Last updated on Jul 16, 2019.
    

    
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    
</footer>

<script type="text/javascript">
var DOCUMENTATION_OPTIONS = {
    URL_ROOT          : '../../',
    VERSION           : '0.7.1',
    COLLAPSE_INDEX    : false,
    FILE_SUFFIX       : '.html',
    HAS_SOURCE        : 'false',
    SOURCELINK_SUFFIX : '.txt'
};
</script>

<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.0.0/anchor.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js"></script>

<script src="../../_static/underscore.js"></script>
<script src="../../_static/doctools.js"></script>
<script src="../../_static/js/searchtools_.js"></script>
<script src="../../_static/js/prism.js"></script>

<script>
$(document).ready(function() {

    // $(".language-default pre").each(function(i, element) {
    //     Prism.highlightElement(element);
    // });

    // $(".language-bash pre").each(function(i, element) {
    //     Prism.highlightElement(element);
    // });

    // $(".language-python pre").each(function(i, element) {
    //     Prism.highlightElement(element);
    // });

    // $(".language-c pre").each(function(i, element) {
    //     Prism.highlightElement(element);
    // });

    // $(".language-cpp pre").each(function(i, element) {
    //     Prism.highlightElement(element);
    // });

    // $(".language-fortran pre").each(function(i, element) {
    //     Prism.highlightElement(element);
    // });

    // $(".language-markdown pre").each(function(i, element) {
    //     Prism.highlightElement(element);
    // });

    // $(".language-rest pre").each(function(i, element) {
    //     Prism.highlightElement(element);
    // });

    anchors.add();
});
</script> 
  </body>
</html>